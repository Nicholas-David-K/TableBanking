{% extends 'base.html' %}

{% block content %}
<div id="short-term-hero-card">
    <div class="container">
        <div class="row justify-content-center">
            <div class="col">
                {% include 'tLoans/partials/_alerts.html' %}
                <div class="jumbotron p-3" id="jumbotron-short">
                    <div class="row">
                        {% for loan in loans %}
                        <div class="col-lg-8">
                            <h6 id="short-loan-heading">Long term loan</h6>
                            <hr>
                            <h6 class="repayment-box text-left" id="short-term-loan-balance" style="font-size:28px;font-weight:bold;">KES {{ loan.amount }}</h6>
                            
                            <small class="text-uppercase" id="payment-plan-heading">payment plan</small>
                            <div class="card" style="border: 0px;">
                                <div class="card-body modal-1 p-0">
                                    {% if loan.get_payment_period_display == 'Twenty Four Months' %}
                                    <small class="text-muted card-subtitle mb-2">Amount to be paid every month for 24 months</small>
                                    {% else %}
                                    <small class="text-muted card-subtitle mb-2">Amount to be paid every month for 36 months</small>
                                    {% endif %}
                                    <h6 id="short-term-loan-balance-1" style="font-size:25px;font-weight:bold;">KES {{ loan.monthly_return_amount | floatformat:0 }}</h6>
                                </div>
                            </div>
                            {% if loan.amount_left %}
                            <small>You have left to pay</small>
                            <h6 style="font-size:20px;font-weight:bold;">KES {{ loan.amount_left }}</h6>
                            {% endif %}
                            <hr>
                            <small>You have paid {{ repayments.count }} months</small>
                            {% if repayments %}
                            <div class="repayment-months-info my-2 scrollable" style="overflow-y: auto; height: 2rem;">
                                {% for item in repayments %}
                                    <small class="badge badge-pill badge-dark p-1">{{ forloop.counter }} payment made: KES {{ item.amount }} <a href="{% url 'delete-long-term-amount' item.pk %}" style="font-size: 12px;" class="text-warning"><i class="far fa-times-circle"></i></a></small>
                                {% endfor %}
                            </div>
                            {% endif %}
                        </div>
                        {% if loan.amount_left != 0 %}
                        <div class="col-lg-4 flex-column align-items-center align-self-center">
                            <h6 class="text-center" id="short-loan-heading">repay</h6><div class="short-term-modal">
                                <form method="POST">
                                    {% csrf_token %}
                                    <div class="form-group">
                                        <!-- <input class="form-control" type="number" name="long-loan" placeholder="Enter amount to repay" /> -->
                                       {{ form.amount }}
                                    </div>
                                    <button class="btn btn-dark btn-block btn-sm" type="submit">Repay</button>
                                </form>
                            </div>
                        </div>
                        {% else %}
                        <div class="col-lg-4 flex-column align-items-center align-self-center text-center mt-3">
                            <i class="far fa-smile fa-2x text-center repayment-box"></i>
                        </div>
                        <a href="{% url 'delete-long-term' loan.pk %}" class="btn btn-danger btn-sm">Delete Loan</a>
                        {% endif %}
                        {% empty %}
                        <div class="col-lg-7 align-items-center align-self-center p-0 text-center">
                            <small>You have no <b>Long Term Loan</b></small>
                        </div>
                        <div class="col-lg-5">
                            <a href="{% url 'home' %}" class="btn btn-dark btn-block btn-sm">Make a Long Term Loan &longrightarrow;</a>
                        </div>
                        {% endfor %}
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
{% endblock content %}